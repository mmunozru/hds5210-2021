Part 1: 5/5

Part 2: 5/5

Nice work.

On the first stretch, it looks like you ran into a couple of hiccups with some of the data structures, but great approach.